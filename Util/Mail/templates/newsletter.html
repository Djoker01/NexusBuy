{% extends "base.html" %}

{% block content %}
<div class="greeting">¬°Hola {{user_name}}! Aqu√≠ tienes tus ofertas {{frequency}}</div>

<div class="message">
    <p>Hemos seleccionado las mejores ofertas {{frequency}} especialmente para ti. ¬°No te las pierdas!</p>
    
    {% if featured_offers %}
    <h3>‚≠ê Ofertas Destacadas</h3>
    <div style="margin: 25px 0;">
        {% for offer in featured_offers %}
        <div style="border: 1px solid #e9ecef; border-radius: 10px; padding: 20px; margin-bottom: 20px; background: #f8f9fa;">
            <div style="display: flex; align-items: start; gap: 20px;">
                {% if offer.image %}
                <div style="flex-shrink: 0;">
                    <img src="{{offer.image}}" alt="{{offer.title}}" style="width: 120px; height: 120px; object-fit: cover; border-radius: 8px;">
                </div>
                {% endif %}
                <div style="flex-grow: 1;">
                    <h4 style="margin-top: 0; margin-bottom: 10px;">{{offer.title}}</h4>
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                        <span style="text-decoration: line-through; color: #6c757d;">${{offer.original_price}}</span>
                        <span style="font-size: 24px; font-weight: bold; color: #dc3545;">${{offer.discount_price}}</span>
                        <span style="background: #dc3545; color: white; padding: 4px 8px; border-radius: 4px; font-size: 14px; font-weight: bold;">
                            -{{offer.discount_percentage}}%
                        </span>
                    </div>
                    <p style="margin-bottom: 10px; color: #6c757d; font-size: 14px;">{{offer.description}}</p>
                    <a href="{{offer.url}}" style="display: inline-block; background: #4361ee; color: white; padding: 8px 20px; border-radius: 4px; text-decoration: none; font-weight: 500;">
                        Ver Oferta
                    </a>
                    {% if offer.expires %}
                    <div style="margin-top: 10px; font-size: 14px; color: #fd7e14;">
                        ‚è∞ Expira: {{offer.expires}}
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    {% if categories %}
    <h3>üè∑Ô∏è Ofertas por Categor√≠a</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 25px 0;">
        {% for category in categories %}
        <div style="border: 1px solid #e9ecef; border-radius: 10px; overflow: hidden;">
            <div style="background: #4361ee; color: white; padding: 15px; font-weight: bold;">
                {{category.name}}
            </div>
            <div style="padding: 20px;">
                <ul style="margin-bottom: 15px;">
                    {% for product in category.products %}
                    <li style="margin-bottom: 8px;">
                        <a href="{{product.url}}" style="color: #4361ee; text-decoration: none;">
                            {{product.name}} - <strong style="color: #dc3545;">${{product.price}}</strong>
                        </a>
                    </li>
                    {% endfor %}
                </ul>
                <a href="{{category.url}}" style="color: #6c757d; font-size: 14px; text-decoration: none;">
                    Ver todas las ofertas de {{category.name}} ‚Üí
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    {% if flash_deals %}
    <h3>‚ö° Ofertas Flash</h3>
    <div class="alert alert-warning">
        <p><strong>Atenci√≥n:</strong> Estas ofertas tienen tiempo limitado. ¬°Apres√∫rate!</p>
    </div>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0;">
        {% for deal in flash_deals %}
        <div style="border: 2px solid #ffc107; border-radius: 10px; padding: 15px; background: #fff3cd;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <span style="background: #dc3545; color: white; padding: 4px 10px; border-radius: 4px; font-size: 12px; font-weight: bold;">
                    FLASH
                </span>
                <span style="font-size: 14px; color: #856404;">
                    ‚è∞ {{deal.time_left}}
                </span>
            </div>
            <h4 style="margin: 10px 0; font-size: 16px;">{{deal.title}}</h4>
            <div style="font-size: 20px; font-weight: bold; color: #dc3545; margin-bottom: 10px;">
                ${{deal.price}}
            </div>
            <a href="{{deal.url}}" style="display: block; text-align: center; background: #dc3545; color: white; padding: 8px; border-radius: 4px; text-decoration: none; font-weight: 500;">
                Comprar Ahora
            </a>
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>

<div class="button-container">
    <a href="{{all_offers_url}}" class="btn">Ver Todas las Ofertas</a>
</div>

<div class="message">
    <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; margin: 25px 0;">
        <h4 style="margin-top: 0;">üìä Estad√≠sticas {{frequency}}</h4>
        <div style="display: flex; justify-content: space-around; text-align: center; flex-wrap: wrap;">
            <div>
                <div style="font-size: 28px; font-weight: bold; color: #4361ee;">{{stats.total_offers}}</div>
                <div style="font-size: 14px; color: #6c757d;">Ofertas activas</div>
            </div>
            <div>
                <div style="font-size: 28px; font-weight: bold; color: #4cc9f0;">{{stats.average_discount}}%</div>
                <div style="font-size: 14px; color: #6c757d;">Descuento promedio</div>
            </div>
            <div>
                <div style="font-size: 28px; font-weight: bold; color: #f72585;">{{stats.free_shipping}}</div>
                <div style="font-size: 14px; color: #6c757d;">Env√≠os gratis</div>
            </div>
        </div>
    </div>
</div>

<div class="alert alert-info">
    <p><strong>üí° ¬øSab√≠as que?</strong> Puedes personalizar las categor√≠as de ofertas que recibes en tu <a href="{{preferences_url}}" style="color: #0d47a1; font-weight: bold;">panel de preferencias</a>.</p>
</div>
{% endblock %}

{% block subject %}üî• Tus ofertas {{frequency}} de NexusBuy{% endblock %}