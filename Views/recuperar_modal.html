<div class="modal fade" id="modalRecuperarContra" tabindex="-1" role="dialog" aria-labelledby="modalRecuperarContraLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header bg-gradient-primary text-white">
                <h5 class="modal-title" id="modalRecuperarContraLabel">
                    <i class="fas fa-key mr-2"></i>Recuperar Contraseña
                </h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                
                <!-- Paso 1: Solicitar Email -->
                <div id="step-email" class="recovery-step">
                    <p class="text-muted mb-4">Ingresa tu dirección de correo electrónico. Te enviaremos un enlace para restablecer tu contraseña.</p>
                    
                    <div class="form-group">
                        <label for="email-recuperacion">Correo Electrónico</label>
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                            </div>
                            <input type="email" id="email-recuperacion" class="form-control" placeholder="correo@ejemplo.com" required>
                        </div>
                        <small class="form-text text-muted">Debe ser el mismo correo con el que te registraste.</small>
                    </div>
                    
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle mr-2"></i>
                        <strong>Importante:</strong> El enlace de recuperación tiene una validez de 1 hora.
                    </div>
                </div>
                
                <!-- Paso 2: Verificar Email -->
                <div id="step-verificar" class="recovery-step" style="display: none;">
                    <div class="text-center py-4">
                        <div class="mb-3">
                            <i class="fas fa-envelope-open-text fa-3x text-primary"></i>
                        </div>
                        <h5 class="text-success">¡Correo Enviado!</h5>
                        <p class="text-muted">
                            Hemos enviado un enlace de recuperación a: 
                            <strong id="email-mostrado"></strong>
                        </p>
                        <div class="alert alert-light border">
                            <small>
                                <i class="fas fa-clock mr-1"></i>
                                <strong>Tiempo estimado:</strong> 1-5 minutos
                            </small>
                        </div>
                        <div class="mt-3">
                            <button id="btn-reeviar" class="btn btn-sm btn-outline-primary">
                                <i class="fas fa-redo mr-1"></i>Reenviar enlace
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Paso 3: Restablecer Contraseña -->
                <div id="step-reset" class="recovery-step" style="display: none;">
                    <p class="text-muted mb-4">Crea una nueva contraseña segura para tu cuenta.</p>
                    
                    <div class="form-group">
                        <label for="nueva-contrasena">Nueva Contraseña</label>
                        <div class="input-group">
                            <input type="password" id="nueva-contrasena" class="form-control" placeholder="Mínimo 8 caracteres" required>
                            <div class="input-group-append">
                                <button class="btn btn-outline-secondary toggle-password" type="button" data-target="#nueva-contrasena">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        <div class="password-strength mt-2">
                            <div class="progress" style="height: 5px;">
                                <div id="password-strength-bar" class="progress-bar" role="progressbar" style="width: 0%"></div>
                            </div>
                            <small id="password-strength-text" class="form-text text-muted"></small>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="confirmar-contrasena">Confirmar Contraseña</label>
                        <div class="input-group">
                            <input type="password" id="confirmar-contrasena" class="form-control" placeholder="Repite tu contraseña" required>
                            <div class="input-group-append">
                                <button class="btn btn-outline-secondary toggle-password" type="button" data-target="#confirmar-contrasena">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        <small id="password-match" class="form-text" style="display: none;"></small>
                    </div>
                    
                    <div class="alert alert-warning">
                        <i class="fas fa-shield-alt mr-2"></i>
                        <strong>Seguridad:</strong> Usa una combinación de letras, números y símbolos.
                    </div>
                </div>
                
                <!-- Paso 4: Éxito -->
                <div id="step-exito" class="recovery-step" style="display: none;">
                    <div class="text-center py-4">
                        <div class="mb-3">
                            <i class="fas fa-check-circle fa-3x text-success"></i>
                        </div>
                        <h5 class="text-success">¡Contraseña Actualizada!</h5>
                        <p class="text-muted">
                            Tu contraseña ha sido restablecida exitosamente.
                        </p>
                        <div class="mt-4">
                            <button id="btn-ir-login" class="btn btn-success">
                                <i class="fas fa-sign-in-alt mr-2"></i>Iniciar Sesión
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Token oculto -->
                <input type="hidden" id="recovery-token" value="">
                
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btn-cancelar">
                    <i class="fas fa-times mr-1"></i>Cancelar
                </button>
                <button type="button" class="btn btn-primary" id="btn-siguiente">
                    <span class="btn-text">Siguiente</span>
                    <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                </button>
            </div>
        </div>
    </div>
</div>

<style>
    .recovery-step {
        transition: all 0.3s ease;
    }
    
    .password-strength .progress-bar {
        transition: width 0.3s ease;
    }
    
    .password-strength-text {
        font-size: 0.85rem;
    }
    
    /* Animaciones */
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .recovery-step.active {
        animation: fadeIn 0.5s ease;
    }
    
    /* Iconos */
    .fa-envelope-open-text {
        color: #4361ee;
    }
    
    .fa-check-circle {
        color: #28a745;
    }
</style>
